---
title: '🐳 開発環境用のDockerfile'
topics: ['2_linux']
authors:
    - tokunaga
description: 'Docker'
pubDate: 'Feb 6 2024'
heroImage: '/img/ubu.jpg'
---

## Dockerfile

```dockerfile title="Dockerfile"
# ベースイメージを指定
FROM archlinux/archlinux:base-devel
LABEL maintainer="Yu Tokunaga <tokunaga@agni.ninja>"

# メタデータを追加
ARG UID=1000
ARG GID=1000
ARG USERNAME=hoe
ARG LOCATE=JP
ARG COUNTRY=ja_JP
ARG ENCODE=UTF-8
ENV TZ=Asia/Tokyo

# Install git
RUN pacman -Syu --needed --noconfirm git

# makepkg user(hoe) and workdir
ARG user=hoe
RUN useradd --system --create-home $user \
  && echo "$user ALL=(ALL:ALL) NOPASSWD:ALL" > /etc/sudoers.d/$user
USER $user

# 環境変数を設定
ENV HOME_PATH=/home/$user

WORKDIR $HOME_PATH

# Install yay
RUN git clone https://aur.archlinux.org/yay.git \
  && cd yay \
  && makepkg -sri --needed --noconfirm \
  && cd \
  # Upgrade
  && yay -Syu \
  # Clean up
  && rm -rf .cache yay

# Fish
RUN yay -S --needed --noconfirm fish
RUN sudo chsh $user -s $(which fish)
SHELL ["fish", "--command"]

# Fisherman
RUN curl -Lo $HOME_PATH/.config/fish/functions/fisher.fish --create-dirs https://git.io/fisher
RUN fisher install oh-my-fish/theme-bobthefish

# fzf
RUN sudo pacman -S --needed --noconfirm fzf
# alt cd
RUN fisher install jethrokuan/z
# alt ls, grep, ps
RUN yay -S --needed --noconfirm exa ripgrep procs neovim

# Neovim
RUN export XDG_CONFIG_HOME=~/.config

# Lazy.nvim
RUN git clone https://github.com/4hoe8pow/nvimenv ~/.config/nvim
RUN rm -rf ~/.config/nvim/.git

# Git
RUN sudo git config --system alias.a add
RUN sudo git config --system alias.c commit
RUN sudo git config --system alias.p push
RUN sudo git config --system alias.st status
RUN sudo git config --system alias.gr "log --graph --date=short --decorate=short --pretty=format:'%Cgreen%h %Creset%cd %Cblue%cn %Cred%d %Creset%s'"
RUN sudo git config --system alias.empty "commit --allow-empty -m \'Initial commit\'"
RUN sudo git config --system alias.ch checkout

# Command Alias
ARG fishrc=$HOME_PATH/.config/fish/config.fish
RUN echo "# Shell Operations" >> $fishrc
RUN echo "alias v='nvim'" >> $fishrc
RUN echo "alias l='exa --color auto --icons'" >> $fishrc
RUN echo "alias la='exa -la --color auto --icons'" >> $fishrc
RUN echo "alias ll='exa -l --color auto --icons'" >> $fishrc
RUN echo "alias tree='exa -T -L 3 --color auto --icons'" >> $fishrc
RUN echo "alias grep='rg'" >> $fishrc
RUN echo "alias ps='procs'" >> $fishrc
RUN echo "# Git" >> $fishrc
RUN echo "alias g='git'" >> $fishrc
RUN echo "alias gst='git st'" >> $fishrc
RUN echo "alias ga='git a'" >> $fishrc
RUN echo "alias gc='git c'" >> $fishrc
RUN echo "alias gp='git p'" >> $fishrc
RUN funcsave fish_config

# キャッシュ削除
RUN sudo pacman -Scc --noconfirm
RUN sudo yay -Scc --noconfirm

ENTRYPOINT ["fish"]
```
